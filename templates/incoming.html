{% extends "page.html" %}

{% block title %}Incoming{% endblock %}

{% block content %}

{% if not files %}
<p>No files in <code>/incoming</code>.<p>
{% endif %}

<dl class="FileList">
  {% for file in files %}

    <dt><span class="Details">{{ file.fdate }} :</span> <code><a href="{{ approot }}/incoming/download/{{ file.name|urlencode }}">{{ file.name }}</a></code> <span class="Details">({{ file.size|delimnumber }} bytes)</span>

    {% if not (op and opfile == file.name) %}

    <dd>
    <form method="post" action="{{ approot }}/incoming">
    <input type="hidden" name="_xsrf" value="{{ req._xsrf }}"/>
    <input type="hidden" name="filename" value="{{ file.name }}"/>
    <input class="FormButton" name="move" type="submit" value="Move">
    <input class="FormButton" name="rename" type="submit" value="Rename">
    <input class="FormButton" name="delete" type="submit" value="Delete">
    </form>

    {% else %}

      {% if op == 'delete' %}
      <dd>
      
      <div class="FormAction">Really delete <code>{{ opfile }}</code>?</div>
      <form method="post" action="{{ approot }}/incoming">
      <input type="hidden" name="_xsrf" value="{{ req._xsrf }}"/>
      <input type="hidden" name="filename" value="{{ opfile }}"/>
      <input type="hidden" name="op" value="{{ op }}"/>
      <input class="FormButton" name="cancel" type="submit" value="Cancel">
      <input class="FormButton" name="confirm" type="submit" value="Delete">
      </form>
      
      {% else %}
      
      <dd>
      <div class="FormAction">Action not implemented: {{ op }}</div>
      
      {% endif %}
    
    {% endif %}

  {% endfor %}
</dl>

{% if formerror %}
<p>{{ formerror }}</p>
{% endif %}

{% endblock %}
