
<dd {% if isselected %}class="FileButtons Selected"{% else %}class="FileButtons"{% endif %}>

{% if not isselected %}

  <form method="post" action="{{ requri }}">
  <input type="hidden" name="_xsrf" value="{{ req._xsrf }}"/>
  <input type="hidden" name="filename" value="{{ file.name }}"/>
  {# All items get "Edit Index". #}
  {% if 'eindex' in fileops %}
    <input class="FormButton" name="eindex" type="submit" value="Edit Index">
  {% endif %}
  {# Only existent files (not directories) get these buttons. #}
  {% if file.isfile and not file.isbroken %}
    {% if 'zip' in fileops and file.ishtml %}
      <input class="FormButton" name="zip" type="submit" value="Zip">
    {% endif %}
    {% if 'movei' in fileops %}
      <input class="FormButton" name="movei" type="submit" value="Move In">
    {% endif %}
    {% if 'moveu' in fileops %}
      <input class="FormButton" name="moveu" type="submit" value="Move Up">
    {% endif %}
    {% if 'rename' in fileops %}
      <input class="FormButton" name="rename" type="submit" value="Rename">
    {% endif %}
    {% if 'delete' in fileops %}
      <input class="FormButton" name="delete" type="submit" value="Delete">
    {% endif %}
  {% endif %}
  </form>

{% else %}

  {% if op == 'delete' %}
  
  <div class="FormAction">Really delete <code>{{ opfile }}</code>?</div>
  <form method="post" action="{{ requri }}">
  <input type="hidden" name="_xsrf" value="{{ req._xsrf }}"/>
  <input type="hidden" name="filename" value="{{ opfile }}"/>
  <input type="hidden" name="op" value="{{ op }}"/>
  <input class="FormButton HotButton" name="confirm" type="submit" value="Delete">
  <input class="FormButton" name="cancel" type="submit" value="Cancel">
  </form>
  
  {% elif op == 'rename' %}

  <div class="FormAction">Rename <code>{{ opfile }}</code> to...</div>
  <form method="post" action="{{ requri }}">
  <input type="hidden" name="_xsrf" value="{{ req._xsrf }}"/>
  <input type="hidden" name="filename" value="{{ opfile }}"/>
  <input type="hidden" name="op" value="{{ op }}"/>
  <div>
    <input class="FormInput" autocomplete="disabled"
      id="newname_field" name="newname" type="input" value="{{ opfile }}" placeholder="New filename">
  </div>
  <div>
    <input class="FormButton HotButton" name="confirm" type="submit" value="Rename">
    <input class="FormButton" name="cancel" type="submit" value="Cancel">
  </div>
  </form>

  {% elif op == 'moveu' %}
  
  <div class="FormAction">Really move <code>{{ opfile }}</code> to <code>/unprocessed</code>?</div>
  <form method="post" action="{{ requri }}">
  <input type="hidden" name="_xsrf" value="{{ req._xsrf }}"/>
  <input type="hidden" name="filename" value="{{ opfile }}"/>
  <input type="hidden" name="op" value="{{ op }}"/>
  <input class="FormButton HotButton" name="confirm" type="submit" value="Move">
  <input class="FormButton" name="cancel" type="submit" value="Cancel">
  </form>
  
  {% elif op == 'movei' %}
  
  <div class="FormAction">Really move <code>{{ opfile }}</code> to <code>/incoming</code>?</div>
  <form method="post" action="{{ requri }}">
  <input type="hidden" name="_xsrf" value="{{ req._xsrf }}"/>
  <input type="hidden" name="filename" value="{{ opfile }}"/>
  <input type="hidden" name="op" value="{{ op }}"/>
  <input class="FormButton HotButton" name="confirm" type="submit" value="Move">
  <input class="FormButton" name="cancel" type="submit" value="Cancel">
  </form>
  
  {% elif op == 'zip' %}
  
  <div class="FormAction">Really zip up <code>{{ opfile }}</code>?</div>
  <form method="post" action="{{ requri }}">
  <input type="hidden" name="_xsrf" value="{{ req._xsrf }}"/>
  <input type="hidden" name="filename" value="{{ opfile }}"/>
  <input type="hidden" name="op" value="{{ op }}"/>
  <input class="FormButton HotButton" name="confirm" type="submit" value="Zip">
  <input class="FormButton" name="cancel" type="submit" value="Cancel">
  </form>
  
  {% else %}
  
  <div class="FormAction">Action not implemented: {{ op }}</div>
  
  {% endif %}

{% endif %}
